<!doctype html>
<html lang="en-US">
	<head>
			<meta charset="utf-8" />
  <title>Creating your own blog using github pages, jekyll and travis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


	
		<link rel="icon" href="/favicon.png">
	


	<script src="../../../../../js/jquery.min.js" type="text/javascript"></script>
<script src="../../../../../js/jquery.mixitup.min.js" type="text/javascript"></script>
<script src="../../../../../js/stickyfill.js" type="text/javascript"></script>

	<!--CDN links for the latest TweenLite, CSSPlugin, and EasePack-->
	<script src="http://www.greensock.com/js/src/utils/SplitText.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/CSSPlugin.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/easing/EasePack.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TimelineLite.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenLite.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.4/hammer.min.js"></script>


	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" href="../../../../../css/font-awesome.min.css" type="text/css">


	
		<link rel="stylesheet" href="../../../../../fancybox/jquery.fancybox.css" type="text/css">
		<script src="../../../../../fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>

		<link rel="stylesheet" href="../../../../../css/post.css" type="text/css">
		<script src="../../../../../js/post.js" type="text/javascript"></script>
	

	<link rel="stylesheet" href="../../../../../css/style.css" type="text/css">

	</head>
	<body>
		
<div class="wrapper cf">
	<div class="content article-entry">
		<header>
			<h1>Creating your own blog using github pages, jekyll and travis</h1>
		</header>
		<small>
			
				<a href="http://iocast.github.io/categories/Miscellaneous/" rel="tag tooltip" class="label light" data-placement="right" data-original-title="2 articles in this category"><i class="fa fa-dot-circle-o"></i> Miscellaneous</a>
			
      <a href="http://iocast.github.io/en/2013/10/08/miscellaneous/github-jekyll-travis.html#disqus_thread" class="scrollTo label label-default light" data-disqus-identifier=""><i class="fa fa-comment-o"></i> ?? Comments</a>
      <span class="label label-default light">Tue Oct 08 2013 00:00:00 GMT+0000</span>
    </small>

		<p>Github offers at the time of writing three different types of pages: for <a href="https://help.github.com/articles/user-organization-and-project-pages" title="Github Pages (Help)">users, organizations and projects</a>. For the users and organizations the <code>master</code> branch is going to be used to deploy as static web page. For projects, means in a repository which is not called <code>username.github.io</code>, a subpath of the user pages would be created <code>username.github.io/projectname</code>.</p>
<p>Hence this post is going to discuss the a simple workflow using <a href="http://github.com/" title="Github">Githubâ€™s</a> user pages, <a href="http://jekyllrb.com" title="Jekyll">jekyll</a> as blog and pseudo dynamic page, <a href="http://travis-ci.org" title="Travis CI">travis</a> as our continuous integration solution for deployment purposes.</p>
<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><p>First setup a new user page on Github using for example the page generator or simply setting up a new repository called <code>username.github.io</code>. Github will automatically create a new <code>master</code> branch which is used for deploying the content to the web server. In our case, we need to have a separate branch for our blog which is setup using <a href="http://jekyllrb.com" title="Jekyll">jekyll</a>. Therefore create a new branch e.g. called <code>develop</code> as follow</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Creates our branch, without any parents (it's an orphan!)</span></span><br><span class="line">git checkout --orphan develop</span><br><span class="line"><span class="comment"># Remove all files from the old working tree</span></span><br><span class="line">git rm -rf .</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"My GitHub Page"</span> &gt; index.html</span><br><span class="line">git add index.html</span><br><span class="line">git commit <span class="operator">-a</span> -m <span class="string">"First pages commit"</span></span><br><span class="line">git push origin develop</span><br></pre></td></tr></table></figure>
<p>Now we are ready to add our <a href="http://jekyllrb.com" title="Jekyll">jekyll</a> page to this <code>develop</code> branch.</p>
<h2 id="Jekyll"><a href="#Jekyll" class="headerlink" title="Jekyll"></a>Jekyll</h2><p>Now that we have a <code>master</code> and <code>develop</code> branch, former for the <a href="http://jekyllrb.com" title="Jekyll">jekyll</a> compilation and later for your source, we can setup our blog. As described in the <a href="http://jekyllrb.com/docs/home/" title="Jekyll Documentation">jekyll documentation</a> we need to have at least a <code>_layouts</code> directory for the templates that wrap posts, a <code>_posts</code> for dynamic content and the rest of html and other files for you layout.</p>
<p>In addition we need to setup a <code>_config.yml</code> file to tell <a href="http://jekyllrb.com" title="Jekyll">jekyll</a> the compilation options. A example could look like the following:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">destination: ./_site&#10;lsi:         true&#10;pygments:    true&#10;markdown:    rdiscount&#10;permalink:   date&#10;rdiscount:&#10;  extensions: [smart]&#10;&#10;exclude: [&#39;Gemfile&#39;, &#39;Gemfile.lock&#39;, &#39;Rakefile&#39;, &#39;README.md&#39;, &#39;update-gh-pages.sh&#39;]</span><br></pre></td></tr></table></figure>
<h2 id="Travis_CI"><a href="#Travis_CI" class="headerlink" title="Travis CI"></a>Travis CI</h2><p><a href="http://travis-ci.org" title="Travis CI">Travis</a> is used to automatically deploy the <code>develop</code> branch and push the result of the <code>jekyll build</code> output to the <code>master</code> branch which the would be published to the Github pages.</p>
<p>For that we need first to get <a href="http://travis-ci.org" title="Travis CI">travis</a> access to our Github repository. If you do not have a <a href="http://travis-ci.org" title="Travis CI">travis</a> account register one on the homepage. On The <a href="http://travis-ci.org" title="Travis CI">travis</a> homepage go to the account settings and get access to the appropriate repository like in the image below:</p>
<p><img src="travis_repository_access.png" alt="Travis Repository Access" title="Travis Repository Access"></p>
<p>The next step is to configure the build process. For that create a new file called <code>.travis.yml</code> in the root directory of the <code>develop</code> branch and add the <code>master</code> branch to the blacklist and the <code>develop</code> branch to the whitelist.</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">language: ruby&#10;rvm: 1.9.3&#10;&#10;branches:&#10;  except:&#10;  - master&#10;&#10;branches:&#10;  only:&#10;  - develop&#10;&#10;script: rake travis</span><br></pre></td></tr></table></figure>
<p>As you can see in the <code>.travis.yml</code> file the <a href="http://jekyllrb.com" title="Jekyll">jekyll</a> deployment starts with the command <code>rake travis</code> which is implemented in the <code>Rakefile</code> file which uses the <code>Gemfile</code> for ruby library dependencies. So create the files <code>Gemfile</code> and <code>Rakefile</code> in the root directory of the <code>develop</code> branch.</p>
<p>For the above <code>_config.yml</code> configuration add the following RubyGem dependencies to the <code>Gemfile</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">source <span class="string">'http://rubygems.org'</span></span><br><span class="line"></span><br><span class="line">gem <span class="string">'jekyll'</span></span><br><span class="line">gem <span class="string">'rdiscount'</span></span><br><span class="line">gem <span class="string">'redcarpet'</span></span><br></pre></td></tr></table></figure>
<p>For <a href="http://travis-ci.org" title="Travis CI">travis</a> deployment add the following task to the <code>Rakefile</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env rake</span></span><br><span class="line"></span><br><span class="line">task <span class="symbol">:travis</span> <span class="keyword">do</span></span><br><span class="line">  system(<span class="string">"jekyll build"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Lastly we need to create a <code>bash</code> script to push the compiled <a href="http://jekyllrb.com" title="Jekyll">jekyll</a> page to the <code>master</code> branch. For that authorize <a href="http://travis-ci.org" title="Travis CI">travis</a> to do commits and pushed as follow:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X POST -u &lt;your_github_username&gt; -H <span class="string">"Content-Type: application/json"</span> <span class="operator">-d</span> <span class="string">"&#123;\"scopes\":[\"public_repo\"],\"note\":\"token for pushing from travis\"&#125;"</span> https://api.github.com/authorizations</span><br></pre></td></tr></table></figure>
<p>and copy the <code>token</code> key from the json result.</p>
<p>Now install the travis gem, encrypt the values of environment variables and add it to the <code>.tavis.yml</code> file:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gem install travis</span><br><span class="line">travis encrypt -r &lt;user&gt;/&lt;repository&gt; GH_TOKEN=&lt;token&gt; --add env.global</span><br></pre></td></tr></table></figure>
<p>Lastly you need to create a bash file which pushes the update to he <code>master</code> branch using the <code>GH_TOKEN</code> which was encrypted before and need to be registered in the <code>.travis.yml</code> as <code>after_success</code> task:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$TRAVIS_PULL_REQUEST</span>"</span> == <span class="string">"false"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"Starting to update master\n"</span></span><br><span class="line"></span><br><span class="line">  cp -R _site <span class="variable">$HOME</span>/_site</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cd</span> <span class="variable">$HOME</span></span><br><span class="line">  git config --global user.email <span class="string">"iocast@me.com"</span></span><br><span class="line">  git config --global user.name <span class="string">"iocast"</span></span><br><span class="line">  git <span class="built_in">clone</span> --quiet --branch=master https://<span class="variable">$&#123;GH_TOKEN&#125;</span>@github.com/iocast/iocast.github.io.git master &gt; /dev/null</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cd</span> master</span><br><span class="line">  rm -rf ./*</span><br><span class="line">  cp -Rf <span class="variable">$HOME</span>/_site/* .</span><br><span class="line"></span><br><span class="line">  git add <span class="operator">-f</span> .</span><br><span class="line">  git commit -m <span class="string">"Travis build <span class="variable">$TRAVIS_BUILD_NUMBER</span> pushed to master"</span></span><br><span class="line">  git push -fq origin master &gt; /dev/null</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"Done magic with coverage\n"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>and add the following lines to the end of the <code>.travis.yml</code> file:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">after_success: ./update-gh-pages.sh</span><br></pre></td></tr></table></figure>



		
		<section id="comments">
			<div id="disqus_thread"></div>
			<script>
			var disqus_config = function () {
				this.page.url = 'http://iocast.github.io/en/2013/10/08/miscellaneous/github-jekyll-travis.html;'
				this.page.identifier = 'en/miscellaneous/github-jekyll-travis';
			};

			(function() {
				var d = document, s = d.createElement('script');

				s.src = '//iocast-blog.disqus.com/embed.js';

				s.setAttribute('data-timestamp', +new Date());
				(d.head || d.body).appendChild(s);
			})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


			<script id="dsq-count-scr" src="//iocast.disqus.com/count.js" async></script>
		</section>
		

	</div>
	<div id="sidebar" class="sidebar">
		<h3>Table of Content</h3>
		<nav class="toc">
			<ol class="toc-item"><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#Github"><span class="toc-item-text">Github</span></a></li><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#Jekyll"><span class="toc-item-text">Jekyll</span></a></li><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#Travis_CI"><span class="toc-item-text">Travis CI</span></a></li></ol>
		</nav>
	</div>
</div>

	</body>
</html>
