<!doctype html>
<html lang="en-US">
	<head>
			<meta charset="utf-8" />
  <title>Ubuntu 12.04, PGSQL 9.3, PostGIS 2.1 and PL/R against libgdal1h from scratch</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


	
		<link rel="icon" href="/favicon.png">
	


	<script src="../../../../../js/jquery.min.js" type="text/javascript"></script>
<script src="../../../../../js/jquery.mixitup.min.js" type="text/javascript"></script>
<script src="../../../../../js/stickyfill.js" type="text/javascript"></script>

	<!--CDN links for the latest TweenLite, CSSPlugin, and EasePack-->
	<script src="http://www.greensock.com/js/src/utils/SplitText.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/CSSPlugin.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/easing/EasePack.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TimelineLite.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenLite.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.4/hammer.min.js"></script>


	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" href="../../../../../css/font-awesome.min.css" type="text/css">


	
		<link rel="stylesheet" href="../../../../../fancybox/jquery.fancybox.css" type="text/css">
		<script src="../../../../../fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>

		<link rel="stylesheet" href="../../../../../css/post.css" type="text/css">
		<script src="../../../../../js/post.js" type="text/javascript"></script>
	

	<link rel="stylesheet" href="../../../../../css/style.css" type="text/css">

	</head>
	<body>
		<div class="wrapper cf">
	<div class="content article-entry">
		<header>
			<h1>Ubuntu 12.04, PGSQL 9.3, PostGIS 2.1 and PL/R against libgdal1h from scratch</h1>
		</header>
		<small>
			
				<a href="http://iocast.github.io/categories/GIS/" rel="tag tooltip" class="label light" data-placement="right" data-original-title="2 articles in this category"><i class="fa fa-dot-circle-o"></i> GIS</a>
			
      <a href="http://iocast.github.io/en/2013/11/11/gis/ubuntu-postgresql-postgis-plr-libgdal1h.html#disqus_thread" class="scrollTo label label-default light" data-disqus-identifier=""><i class="fa fa-comment-o"></i> ?? Comments</a>
      <span class="label label-default light">Mon Nov 11 2013 00:00:00 GMT+0000</span>
    </small>

		<h2 id="Removing-preinstalled-packages"><a href="#Removing-preinstalled-packages" class="headerlink" title="Removing preinstalled packages"></a>Removing preinstalled packages</h2><p>First we need to check which PostgreSQL, PostGIS and GDAL versions are installed. To do so check your Debian package management system (dpkg).</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dpkg <span class="operator">-l</span> | grep <span class="string">'postgres\|gdal'</span></span><br></pre></td></tr></table></figure>
<p>You should get a list like the following one:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ii  libgdal-dev                        <span class="number">1.10</span>.<span class="number">0</span>-<span class="number">1</span>~precise1                 Geospatial Data Abstraction Library - Development files</span><br><span class="line">ii  libgdal1-dev                       <span class="number">1.10</span>.<span class="number">0</span>-<span class="number">1</span>~precise1                 Geospatial Data Abstraction Library - Development files</span><br><span class="line">ii  libgdal1h                          <span class="number">1.10</span>.<span class="number">0</span>-<span class="number">1</span>~precise1                 Geospatial Data Abstraction Library</span><br><span class="line">ii  postgresql-<span class="number">9.1</span>                     <span class="number">9.1</span>.<span class="number">10</span>-<span class="number">0</span>ubuntu12.<span class="number">04</span>               object-relational SQL database, version <span class="number">9.1</span> server</span><br><span class="line">ii  postgresql-<span class="number">9.1</span>-postgis-<span class="number">2.0</span>         <span class="number">2.0</span>.<span class="number">3</span>-<span class="number">2</span>~precise4                  Geographic objects support <span class="keyword">for</span> PostgreSQL <span class="number">9.1</span></span><br><span class="line">ii  postgresql-<span class="number">9.1</span>-postgis-<span class="number">2.0</span>-scripts <span class="number">2.0</span>.<span class="number">3</span>-<span class="number">2</span>~precise4                  Geographic objects support <span class="keyword">for</span> PostgreSQL <span class="number">9.1</span> -- scripts</span><br><span class="line">ii  postgresql-client-<span class="number">9.1</span>              <span class="number">9.1</span>.<span class="number">10</span>-<span class="number">0</span>ubuntu12.<span class="number">04</span>               front-end programs <span class="keyword">for</span> PostgreSQL <span class="number">9.1</span></span><br><span class="line">ii  postgresql-client-common           <span class="number">129</span>ubuntu1                        manager <span class="keyword">for</span> multiple PostgreSQL client versions</span><br><span class="line">ii  postgresql-common                  <span class="number">129</span>ubuntu1                        PostgreSQL database-cluster manager</span><br><span class="line">ii  postgresql-contrib-<span class="number">9.1</span>             <span class="number">9.1</span>.<span class="number">10</span>-<span class="number">0</span>ubuntu12.<span class="number">04</span>               additional facilities <span class="keyword">for</span> PostgreSQL</span><br></pre></td></tr></table></figure>
<p>If you want, you could remove these packages as follow:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get purge libgdal-dev libgdal1-dev libgdal1h postgresql-<span class="number">9.1</span> postgresql-<span class="number">9.1</span>-postgis-<span class="number">2.0</span> postgresql-<span class="number">9.1</span>-postgis-<span class="number">2.0</span>-scripts postgresql-client-<span class="number">9.1</span> postgresql-client-common postgresql-common</span><br><span class="line">apt-get autoremove</span><br><span class="line">apt-get autoclean</span><br></pre></td></tr></table></figure>
<h2 id="Installing-PostgreSQL-9-3"><a href="#Installing-PostgreSQL-9-3" class="headerlink" title="Installing PostgreSQL 9.3"></a>Installing PostgreSQL 9.3</h2><p>First you need to find out your release code name:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lsb_release -c</span><br></pre></td></tr></table></figure>
<p>which get you something like that <code>Codename:    precise</code></p>
<p>Create a new file <code>codename-pgdg.list</code> in <code>/etc/apt/sources.list.d</code> according to the <a href="https://wiki.postgresql.org/wiki/Apt" title="Apt - PostgreSQL wiki">PostgreSQL wiki page</a>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/apt/sources.list.d/precise-pgdg.list</span><br></pre></td></tr></table></figure>
<p>and add the following line</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deb http://apt.postgresql.org/pub/repos/apt/ precise-pgdg main</span><br></pre></td></tr></table></figure>
<p>Now we need to import the repository key from</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget --quiet -O - http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc | sudo apt-key add -</span><br></pre></td></tr></table></figure>
<p>Now we can a update the repository and install the required packages from the PostgreSQL repository.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install postgresql-<span class="number">9.3</span> postgresql-contrib-<span class="number">9.3</span> postgresql-server-dev-<span class="number">9.3</span></span><br></pre></td></tr></table></figure>
<h2 id="Compiling-PostGIS-2-1-against-libgdal-gt-1-10-0"><a href="#Compiling-PostGIS-2-1-against-libgdal-gt-1-10-0" class="headerlink" title="Compiling PostGIS 2.1 against libgdal &gt;= 1.10.0"></a>Compiling PostGIS 2.1 against libgdal &gt;= 1.10.0</h2><p>To install PostGIS 2.1 it is important that <code>postgresql-server-dev-x.x</code> is installed, because we need to compile PostGIS against these source files. We are going the install the precompiled <code>libgdal</code> 1.10.0 version from <strong>ubuntugis</strong>.</p>
<p>Install <code>python-software-properties</code> and add the apt sources (repositories):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install python-software-properties</span><br><span class="line">add-apt-repository ppa:ubuntugis/ubuntugis-unstable</span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure>
<p>Now install the new GDAL library called <code>libgdal1h</code> and its’ development package</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install libgdal1h</span><br><span class="line">apt-cache showpkg libgdal-dev*</span><br></pre></td></tr></table></figure>
<p>which gets you something like that:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">Provides:</span><br><span class="line"><span class="number">1.10</span>.<span class="number">0</span>-<span class="number">1</span>~precise1 -</span><br><span class="line"><span class="number">1.9</span>.<span class="number">0</span>-<span class="number">3.1</span>~pgdg12.<span class="number">4</span>+<span class="number">1</span> -</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>You can install a version using the <figure class="highlight"><figcaption><span>flag</span></figcaption><table><tr><td class="code"><pre><span class="line">&#10;```bash&#10;apt-get install -f libgdal-dev=1.10.0-1~precise1</span><br></pre></td></tr></table></figure></p>
<p>Before installing the PostGIS from source we install the required dependencies.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install make gcc checkinstall libxml2-dev libproj-dev libgeos-dev</span><br></pre></td></tr></table></figure>
<p>Download the latest PostGIS source and compile it</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget http://download.osgeo.org/postgis/<span class="built_in">source</span>/postgis-<span class="number">2.1</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">tar xzvf postgis-<span class="number">2.1</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"><span class="built_in">cd</span> postgis-<span class="number">2.1</span>.<span class="number">0</span></span><br><span class="line">./configure</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> PostGIS is now configured <span class="keyword">for</span> x86_64-unknown-linux-gnu</span><br><span class="line"></span><br><span class="line">-------------- Compiler Info -------------</span><br><span class="line"> C compiler:           gcc -g -O2</span><br><span class="line"> C++ compiler:         g++ -g -O2</span><br><span class="line"> SQL preprocessor:     /usr/bin/cpp -traditional-cpp -P</span><br><span class="line"></span><br><span class="line">-------------- Dependencies --------------</span><br><span class="line"> GEOS config:          /usr/bin/geos-config</span><br><span class="line"> GEOS version:         <span class="number">3.3</span>.<span class="number">8</span></span><br><span class="line"> GDAL config:          /usr/bin/gdal-config</span><br><span class="line"> GDAL version:         <span class="number">1.10</span>.<span class="number">0</span></span><br><span class="line"> PostgreSQL config:    /usr/bin/pg_config</span><br><span class="line"> PostgreSQL version:   PostgreSQL <span class="number">9.3</span>.<span class="number">1</span></span><br><span class="line"> PROJ4 version:        <span class="number">48</span></span><br><span class="line"> Libxml2 config:       /usr/bin/xml2-config</span><br><span class="line"> Libxml2 version:      <span class="number">2.8</span>.<span class="number">0</span></span><br><span class="line"> JSON-C support:       no</span><br><span class="line"> PostGIS debug level:  <span class="number">0</span></span><br><span class="line"> Perl:                 /usr/bin/perl</span><br><span class="line"></span><br><span class="line">--------------- Extensions ---------------</span><br><span class="line"> PostGIS Raster:       enabled</span><br><span class="line"> PostGIS Topology:     enabled</span><br><span class="line"> SFCGAL support:       disabled</span><br><span class="line"></span><br><span class="line">-------- Documentation Generation --------</span><br><span class="line"> xsltproc:             </span><br><span class="line"> xsl style sheets:     </span><br><span class="line"> dblatex:              </span><br><span class="line"> convert:              </span><br><span class="line"> mathml2.dtd:          http://www.w3.org/Math/DTD/mathml2/mathml2.dtd</span><br></pre></td></tr></table></figure>
<p>use <code>checkinstall</code>, which runs <code>make install</code> and registers the package in <code>dpkg</code>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make</span><br><span class="line">checkinstall</span><br></pre></td></tr></table></figure>
<h2 id="R-3-0-2-and-PL-R-for-PostgreSQL"><a href="#R-3-0-2-and-PL-R-for-PostgreSQL" class="headerlink" title="R 3.0.2 and PL/R for PostgreSQL"></a>R 3.0.2 and PL/R for PostgreSQL</h2><p>Before we can install PL/R extension for PostgreSQL 9.3 we need to install R 3.0.2 as describe on the <a href="http://cran.r-project.org" title="The Comprehensive R Archive Network">R-Project</a> site. First edit the</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>and add the following line and do a update</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deb http://cran.r-project.org/bin/linux/ubuntu precise/</span><br></pre></td></tr></table></figure>
<p>as well as the key</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E084DAB9</span><br><span class="line">apt-get update</span><br></pre></td></tr></table></figure>
<p>The search for the 3.0.2 R package version and install it.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-cache showpkg r-base</span><br><span class="line">apt-get install <span class="operator">-f</span> r-base=<span class="number">3.0</span>.<span class="number">2</span>-<span class="number">1</span>precise0</span><br></pre></td></tr></table></figure>
<p>Lastly we can install the PL/R extension for PostgreSQL from the PostgreSQL apt repository</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install postgresql-<span class="number">9.3</span>-plr</span><br></pre></td></tr></table></figure>
<p>So … we are ready … have fun.</p>



		
		<section id="comments">
			<div id="disqus_thread"></div>
			<script>
			var disqus_config = function () {
				this.page.url = 'http://iocast.github.io/en/2013/11/11/gis/ubuntu-postgresql-postgis-plr-libgdal1h.html;'
				this.page.identifier = 'en/gis/ubuntu-postgresql-postgis-plr-libgdal1h';
			};

			(function() {
				var d = document, s = d.createElement('script');

				s.src = '//iocast-blog.disqus.com/embed.js';

				s.setAttribute('data-timestamp', +new Date());
				(d.head || d.body).appendChild(s);
			})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


			<script id="dsq-count-scr" src="//iocast.disqus.com/count.js" async></script>
		</section>
		

	</div>
	<div id="sidebar" class="sidebar">
		<h3>Table of Content</h3>
		<nav class="toc">
			<ol class="toc-item"><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#Removing-preinstalled-packages"><span class="toc-item-text">Removing preinstalled packages</span></a></li><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#Installing-PostgreSQL-9-3"><span class="toc-item-text">Installing PostgreSQL 9.3</span></a></li><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#Compiling-PostGIS-2-1-against-libgdal-gt-1-10-0"><span class="toc-item-text">Compiling PostGIS 2.1 against libgdal >= 1.10.0</span></a></li><li class="toc-item-item toc-item-level-2"><a class="toc-item-link" href="#R-3-0-2-and-PL-R-for-PostgreSQL"><span class="toc-item-text">R 3.0.2 and PL/R for PostgreSQL</span></a></li></ol>
		</nav>
	</div>
</div>

	</body>
</html>
