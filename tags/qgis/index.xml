<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Qgis on think twice code once!</title>
    <link>http://iocast.github.io/tags/qgis/index.xml</link>
    <description>Recent content in Qgis on think twice code once!</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    <copyright>All rights reserved Â© 2017</copyright>
    <atom:link href="http://iocast.github.io/tags/qgis/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Setting up a QGIS server and PostGIS on CentOS 6</title>
      <link>http://iocast.github.io/post/gis/qgis-server-centos/</link>
      <pubDate>Sat, 12 Oct 2013 00:00:00 +0000</pubDate>
      
      <guid>http://iocast.github.io/post/gis/qgis-server-centos/</guid>
      <description>

&lt;p&gt;QGIS server provides a web map server (WMS) by simply copying a QGIS project int the server directory. If you want to depend on newer &lt;code&gt;postgresql-libs&lt;/code&gt; you need first to install the desired version of PostgreSQL and PostGIS as described bellow.&lt;/p&gt;

&lt;h2 id=&#34;postgresql-and-postgis&#34;&gt;PostgreSQL and PostGIS&lt;/h2&gt;

&lt;p&gt;The following instructions are adapted from  &lt;a href=&#34;http://wiki.postgresql.org/wiki/YUM_Installation#Configure_your_YUM_repository&#34;&gt;YUM installation - PostgreSQL wiki&lt;/a&gt; and &lt;a href=&#34;http://trac.osgeo.org/postgis/wiki/UsersWikiPostGIS20CentOS6pgdg&#34;&gt;UsersWikiuPostGIS20CentOS6pgdg - PostGIS&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;configuration&#34;&gt;Configuration&lt;/h3&gt;

&lt;p&gt;Configure yum repository&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;	vi /etc/yum.repos.d/CentOS-Base.repo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and add the following excludes to &lt;code&gt;base&lt;/code&gt; and &lt;code&gt;updates&lt;/code&gt; sections:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;exclude=postgresql*
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;install-pgdg-rpm-file&#34;&gt;Install PGDG RPM file&lt;/h3&gt;

&lt;p&gt;A PGDG file is available for each distribution/architecture/database version combination at &lt;a href=&#34;http://yum.postgresql.org&#34;&gt;http://yum.postgresql.org&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;	wget http://yum.postgresql.org/&amp;lt;version&amp;gt;/&amp;lt;distribution&amp;gt;/&amp;lt;architecture&amp;gt;/pgdg-&amp;lt;database&amp;gt;.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where version is &lt;code&gt;9.3&lt;/code&gt;, distribution is &lt;code&gt;redhat&lt;/code&gt;, architecture is &lt;code&gt;rhel-6-x86_64&lt;/code&gt; and database is &lt;code&gt;centos93-9.3-1&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Install RPM distribution:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;	rpm -ivh pgdg-centos93-9.3-1.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;installation-of-postgresql-and-postgis&#34;&gt;Installation of PostgreSQL and PostGIS&lt;/h3&gt;

&lt;p&gt;List the available packages:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:::bash
yum list postgres*
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Installation:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:::bash
yum install postgresql93-libs.x86_64 postgresql93-server.x86_64 postgresql93-devel.x86_64 postgis2_93
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;configuration-1&#34;&gt;Configuration&lt;/h3&gt;

&lt;p&gt;Now perform a few post-installation setup commands, in the order: (1) Initialize the database cluster (required), (2) start database (recommended, if you want to use it straight away), (3) allow it to start-up automatically on reboot (recommended):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:::bash
service postgresql-9.3 initdb
service postgresql-9.3 start
chkconfig postgresql-9.3 on
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Some important files&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;File / Application&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Purpose&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;/var/lib/pgsql/9.3/data/postgresql.conf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;changing host etc.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;/var/lib/pgsql/9.3/data/pg_hba.conf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;client authentication configuration&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;In the &lt;code&gt;pg_hba.conf&lt;/code&gt; file comment out the &lt;code&gt;ident&lt;/code&gt; lines except for unix domain socket and add two new lines for &lt;code&gt;md5 encryption&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:::yaml
# IPv4 local connections:
#host    all             all             127.0.0.1/32            ident
host    all             all             127.0.0.1/32            md5
# IPv6 local connections:
#host    all             all             ::1/128                 ident
host    all             all             ::1/128                 md5
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;database-and-user&#34;&gt;Database and User&lt;/h3&gt;

&lt;p&gt;Before we can start, we need to create a new database and user.&lt;/p&gt;

&lt;p&gt;Login as &lt;code&gt;postgres&lt;/code&gt; superuser and create a new database&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:::bash
su -l postgres
createdb gis
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Login into the database create a user and set a encrypted password&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:::bash
psql gis
CREATE USER gis WITH SUPERUSER LOGIN PASSWORD &#39;gis&#39;;
ALTER USER gis WITH ENCRYPTED PASSWORD &#39;gis&#39;;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now test your configuration and install PostGIS extension&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;psql -h localhost -d gis -U gis -W
CREATE EXTENSION postgis;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;installation-qgis&#34;&gt;Installation QGIS&lt;/h2&gt;

&lt;p&gt;First you need a running CentOS on a machine. In the default CentOS software repository &lt;code&gt;qgis-server&lt;/code&gt; is not available. So you need first to add extra packages for enterprise linux (EPEL) repository as follow:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-&amp;lt;version&amp;gt;.noarch.rpm
rpm -Uvh epel-release-&amp;lt;version&amp;gt;.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where the version I have tested it was &lt;code&gt;6-8&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Add the ELGIS repositories&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget http://elgis.argeo.org/repos/6/elgis-release-&amp;lt;version&amp;gt;.noarch.rpm
rpm -Uvh elgis-release-6-6_0.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where the version I have tested it was &lt;code&gt;6-6_0&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Now install QGIS server:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;yum install qgis-mapserver.x86_64
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you want to have QGIS libraries, QGIS Desktop run the following command&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;yum install qgis*
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The scripts and configs are installed on CentOS:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;Script / Config&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Purpose&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;/usr/libexec/qgis/qgis_mapserv.fcgi&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;main fast cgi script (OGC capabilities)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;/etc/httpd/conf.d/qgis-mapserver.conf&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;qgis mapserver httpd configuration file&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</description>
    </item>
    
  </channel>
</rss>