<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Centos on think twice code once!</title>
    <link>http://iocast.github.io/tags/centos/</link>
    <description>Recent content in Centos on think twice code once!</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    <copyright>All rights reserved Â© 2017</copyright>
    <lastBuildDate>Mon, 21 Jul 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://iocast.github.io/tags/centos/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Javascript localization part 1</title>
      <link>http://iocast.github.io/post/web-application/javascript-internationalization-part1/</link>
      <pubDate>Mon, 21 Jul 2014 00:00:00 +0000</pubDate>
      
      <guid>http://iocast.github.io/post/web-application/javascript-internationalization-part1/</guid>
      <description><p>Take some seconds and thing about how you represent a date or number. Do you convert the object to a string and slices it at the needed position? Or do you extend the Date class and adds some new output representation functionality.</p>

<p>Since the ECMA-402 Standard, published on December 2012, you have some really great new functions which respects the locale settings of your environment.</p>

<p>Okey, lets take a step back. When I was working on my semantic web library calendar web component I searched for a way to represent a Date object inside the DOM tree in different way. One question was is how to represent a Date object in the format  <code>mmmm yyyy</code> or <code>mm/dd/yyyy</code>. So I began to search for examples in the web and many entries dated back to 2009, 2010 and 2011. Some of them were also from 2013, which we really astound. Nonetheless, all answers had once thing in common. They put each component of the representation manually inside a string.</p>

<pre><code class="language-javascript">	var dateobj= new Date()
	dateobj.getDate() + &quot;/&quot; + dateobj.getMonth()+1 + &quot;/&quot; + dateobj.getFullYear()
	// 21/7/2014
</code></pre>

<p>or</p>

<pre><code class="language-javascript">	Date.locale = {
		en: {
			month_names: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
			month_names_short: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
		}
	};

	Date.prototype.getMonthName = function(lang) {
		lang = lang &amp;&amp; (lang in Date.locale) ? lang : 'en';
		return Date.locale[lang].month_names[this.getMonth()];
	};
	Date.prototype.getMonthNameShort = function(lang) {
		lang = lang &amp;&amp; (lang in Date.locale) ? lang : 'en';
		return Date.locale[lang].month_names_short[this.getMonth()];
	};

	// that can be used as follow:
	var now = new Date();
	now.getMonthNameShort + &quot; &quot; + now.getFullYear();
	// July 2014
</code></pre>

<p>The problem you have with these solutions is that they not respect the language sensitive representation of a Date or Number object.</p>

<p>The solution for this is quite simple. Javascript now provides different functions which respect the locale settings of the environment.</p>

<p>For the <code>Date</code> object now have these functions, whereas I personally prefer the <code>toLocaleString()</code></p>

<table>
<thead>
<tr>
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Date.prototype.toLocaleDateString()</td>
<td align="left">returns a string with a language sensitive representation of the date portion of this date.</td>
</tr>

<tr>
<td align="left">Date.prototype.toLocaleString()</td>
<td align="left">returns a string with a language sensitive representation of this date.</td>
</tr>

<tr>
<td align="left">Date.prototype.toLocaleTimeString()</td>
<td align="left">returns a string with a language sensitive representation of the time portion of this date.</td>
</tr>
</tbody>
</table>

<p>You can use it as follow</p>

<pre><code class="language-javascript">	var now = new Date()
	date.toLocaleString('en', { month: 'long', year: 'numeric' });
	// July 2014
	date.toLocaleString('en', { month: '2-digit', day: '2-digit', year: 'numberic' });
	// 21/07/2014
</code></pre>

<p>where the first parameter is the <code>locale</code> and the second parameter represents the <code>options</code>. The allowed options can be found on the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString">Mozilla Developer Network</a>. As you can see in the example the main advantage is that you do need to worry about the representation of the date format in the different languages and that you do not need to add manually a leading zero if necessary.</p>

<p>The same applies to the <code>Number</code> object.</p>

<table>
<thead>
<tr>
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Number.prototype.toLocaleString()</td>
<td align="left">returns a string with a language sensitive representation of this number.</td>
</tr>
</tbody>
</table>

<p>You can use it as follow</p>

<pre><code class="language-javascript">	var number = 3600;
	number.toLocaleString('en');
	// 3,600
	number.toLocaleString('de');
	// 3.600
	number.toLocaleString('en', {
		style: 'currency',
		currency: 'USD'
	});
	// $3,600
</code></pre>
</description>
    </item>
    
    <item>
      <title>Python 2.7.x and mod_wsgi on a CentOS 6</title>
      <link>http://iocast.github.io/post/web-application/centos-python-modwsgi/</link>
      <pubDate>Wed, 16 Oct 2013 00:00:00 +0000</pubDate>
      
      <guid>http://iocast.github.io/post/web-application/centos-python-modwsgi/</guid>
      <description>

<p>When you have installed CentOS 6 using the minimal image we need first to do some preparation. Fist login into your system and enable your <code>eth0</code> at startup.</p>

<pre><code class="language-bash">vi /etc/sysconfig/network-scripts/ifcfg-eth0
</code></pre>

<p>and set <code>ONBOOT</code> to <code>yes</code>.</p>

<h2 id="getting-python-2-7-x">Getting Python 2.7.x</h2>

<p>The following explanations are based on a blog of <a href="http://blog.nickhowell.co.uk/2010/11/30/setup-osqa-on-centos-5-5" title="Setup OSQA on CentOS 5.5 | nickhowell.co.uk">Asim Teeshan</a> and a post on <a href="http://www.fir3net.com/Redhat-/-Fedora/how-do-i-compile-modwgsi-for-python-27.html" title="How do I compile mod_wsgi for Python 2.7">Fire3Net</a>.</p>

<p>First we need some development tools. Install the following once</p>

<pre><code class="language-bash">yum install gcc make zlib-devel bzip2-devel openssl-devel
</code></pre>

<p>Now download the latest 2.7.x Python release and enable shared library during the configuation</p>

<pre><code class="language-bash">cd /opt/
wget http://python.org/ftp/python/2.7.5/Python-2.7.5.tgz
</code></pre>

<p>Extract and install it:</p>

<pre><code class="language-bash">tar -zxvf Python-2.7.5.tgz
cd Python-2.7.5
./configure --enable-shared
make &amp;&amp; make altinstall
</code></pre>

<p>Install Python setuptools for using <code>easy_setup</code></p>

<pre><code class="language-bash">wget http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg
sh setuptools-0.6c11-py2.7.egg
</code></pre>

<p>Before we can install <code>mod_wsgi</code> we need to install the http development libraries</p>

<pre><code class="language-bash">yum install httpd httpd-devel
</code></pre>

<p>Now we are ready to compile <code>mod_wsgi</code> against Python 2.7.x</p>

<p>Download and unpack the latest version</p>

<pre><code class="language-bash">wget http://modwsgi.googlecode.com/files/mod_wsgi-3.4.tar.gz
tar -zxvf mod_wsgi-3.4.tar.gz
cd mod_wsgi-3.4.tar.gz
./configure --with-python=/usr/local/bin/python2.7
</code></pre>

<p>Make sure you specify the path to the python binary. You can find out where your Python binary is by issuing the following command:</p>

<pre><code class="language-bash">whereis python
</code></pre>

<p>Once the configuration completed you can install it:</p>

<pre><code class="language-bash">make &amp;&amp; make install
</code></pre>

<p>If you run into problems along the lines <strong>cannot load shared library libpython2.7&hellip;</strong> then you need run the <code>ldconfig</code> first to tell where the <code>libpython2.7.so*</code> files are:</p>

<pre><code class="language-bash">ln -s /usr/local/lib/libpython2.7.so.1.0 /usr/lib/
ln -s /usr/local/lib/libpython2.7.so /usr/
ldconfig
</code></pre>

<p>Lastly we can install <code>virtualenv</code> as follow:</p>

<pre><code class="language-bash">wget http://pypi.python.org/packages/source/v/virtualenv/virtualenv-1.10.1.tar.gz
tar -zxvf virtualenv-1.10.1.tar.gz
cd virtualenv-1.10.1
python2.7 setup.py install
</code></pre>

<p>install psycopg2</p>

<pre><code class="language-bash">wget --no-check-certificate https://pypi.python.org/packages/source/p/psycopg2/psycopg2-2.5.1.tar.gz
tar -zxvf psycopg2-2.5.1.tar.gz
cd psycopg2-2.5.1
vi setup.cfg
</code></pre>

<p>and add the following line</p>

<pre><code>pg_config=/usr/pgsql-9.3/bin/pg_config
</code></pre>

<p>now install it</p>

<pre><code class="language-bash">/usr/local/bin/python2.7 setup.py install
</code></pre>

<p>now creating a virtual env for you web application do it as follow</p>

<pre><code class="language-bash">virtualenv-2.7 --system-site-packages ENV
</code></pre>
</description>
    </item>
    
    <item>
      <title>Setting up a QGIS server and PostGIS on CentOS 6</title>
      <link>http://iocast.github.io/post/gis/qgis-server-centos/</link>
      <pubDate>Sat, 12 Oct 2013 00:00:00 +0000</pubDate>
      
      <guid>http://iocast.github.io/post/gis/qgis-server-centos/</guid>
      <description>

<p>QGIS server provides a web map server (WMS) by simply copying a QGIS project int the server directory. If you want to depend on newer <code>postgresql-libs</code> you need first to install the desired version of PostgreSQL and PostGIS as described bellow.</p>

<h2 id="postgresql-and-postgis">PostgreSQL and PostGIS</h2>

<p>The following instructions are adapted from  <a href="http://wiki.postgresql.org/wiki/YUM_Installation#Configure_your_YUM_repository">YUM installation - PostgreSQL wiki</a> and <a href="http://trac.osgeo.org/postgis/wiki/UsersWikiPostGIS20CentOS6pgdg">UsersWikiuPostGIS20CentOS6pgdg - PostGIS</a>.</p>

<h3 id="configuration">Configuration</h3>

<p>Configure yum repository</p>

<pre><code class="language-bash">	vi /etc/yum.repos.d/CentOS-Base.repo
</code></pre>

<p>and add the following excludes to <code>base</code> and <code>updates</code> sections:</p>

<pre><code class="language-yaml">exclude=postgresql*
</code></pre>

<h3 id="install-pgdg-rpm-file">Install PGDG RPM file</h3>

<p>A PGDG file is available for each distribution/architecture/database version combination at <a href="http://yum.postgresql.org">http://yum.postgresql.org</a></p>

<pre><code class="language-bash">	wget http://yum.postgresql.org/&lt;version&gt;/&lt;distribution&gt;/&lt;architecture&gt;/pgdg-&lt;database&gt;.noarch.rpm
</code></pre>

<p>where version is <code>9.3</code>, distribution is <code>redhat</code>, architecture is <code>rhel-6-x86_64</code> and database is <code>centos93-9.3-1</code>.</p>

<p>Install RPM distribution:</p>

<pre><code class="language-bash">	rpm -ivh pgdg-centos93-9.3-1.noarch.rpm
</code></pre>

<h3 id="installation-of-postgresql-and-postgis">Installation of PostgreSQL and PostGIS</h3>

<p>List the available packages:</p>

<pre><code>:::bash
yum list postgres*
</code></pre>

<p>Installation:</p>

<pre><code>:::bash
yum install postgresql93-libs.x86_64 postgresql93-server.x86_64 postgresql93-devel.x86_64 postgis2_93
</code></pre>

<h3 id="configuration-1">Configuration</h3>

<p>Now perform a few post-installation setup commands, in the order: (1) Initialize the database cluster (required), (2) start database (recommended, if you want to use it straight away), (3) allow it to start-up automatically on reboot (recommended):</p>

<pre><code>:::bash
service postgresql-9.3 initdb
service postgresql-9.3 start
chkconfig postgresql-9.3 on
</code></pre>

<p>Some important files</p>

<table>
<thead>
<tr>
<th align="left">File / Application</th>
<th align="left">Purpose</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">/var/lib/pgsql/9.3/data/postgresql.conf</td>
<td align="left">changing host etc.</td>
</tr>

<tr>
<td align="left">/var/lib/pgsql/9.3/data/pg_hba.conf</td>
<td align="left">client authentication configuration</td>
</tr>
</tbody>
</table>

<p>In the <code>pg_hba.conf</code> file comment out the <code>ident</code> lines except for unix domain socket and add two new lines for <code>md5 encryption</code></p>

<pre><code>:::yaml
# IPv4 local connections:
#host    all             all             127.0.0.1/32            ident
host    all             all             127.0.0.1/32            md5
# IPv6 local connections:
#host    all             all             ::1/128                 ident
host    all             all             ::1/128                 md5
</code></pre>

<h3 id="database-and-user">Database and User</h3>

<p>Before we can start, we need to create a new database and user.</p>

<p>Login as <code>postgres</code> superuser and create a new database</p>

<pre><code>:::bash
su -l postgres
createdb gis
</code></pre>

<p>Login into the database create a user and set a encrypted password</p>

<pre><code>:::bash
psql gis
CREATE USER gis WITH SUPERUSER LOGIN PASSWORD 'gis';
ALTER USER gis WITH ENCRYPTED PASSWORD 'gis';
</code></pre>

<p>Now test your configuration and install PostGIS extension</p>

<pre><code class="language-bash">psql -h localhost -d gis -U gis -W
CREATE EXTENSION postgis;
</code></pre>

<h2 id="installation-qgis">Installation QGIS</h2>

<p>First you need a running CentOS on a machine. In the default CentOS software repository <code>qgis-server</code> is not available. So you need first to add extra packages for enterprise linux (EPEL) repository as follow:</p>

<pre><code class="language-bash">wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-&lt;version&gt;.noarch.rpm
rpm -Uvh epel-release-&lt;version&gt;.noarch.rpm
</code></pre>

<p>where the version I have tested it was <code>6-8</code>.</p>

<p>Add the ELGIS repositories</p>

<pre><code class="language-bash">wget http://elgis.argeo.org/repos/6/elgis-release-&lt;version&gt;.noarch.rpm
rpm -Uvh elgis-release-6-6_0.noarch.rpm
</code></pre>

<p>where the version I have tested it was <code>6-6_0</code>.</p>

<p>Now install QGIS server:</p>

<pre><code class="language-bash">yum install qgis-mapserver.x86_64
</code></pre>

<p>If you want to have QGIS libraries, QGIS Desktop run the following command</p>

<pre><code class="language-bash">yum install qgis*
</code></pre>

<p>The scripts and configs are installed on CentOS:</p>

<table>
<thead>
<tr>
<th align="left">Script / Config</th>
<th align="left">Purpose</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">/usr/libexec/qgis/qgis_mapserv.fcgi</td>
<td align="left">main fast cgi script (OGC capabilities)</td>
</tr>

<tr>
<td align="left">/etc/httpd/conf.d/qgis-mapserver.conf</td>
<td align="left">qgis mapserver httpd configuration file</td>
</tr>
</tbody>
</table>
</description>
    </item>
    
  </channel>
</rss>