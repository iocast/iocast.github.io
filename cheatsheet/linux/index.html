<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="blog, cheatsheets, best practices, and more">
  <meta name="author" content="Iocast">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

  <title>Linux -- think twice code once!</title>


  


  
  <link rel="stylesheet" type="text/css" href="https://iocast.github.io/semantic/semantic.min.css">

  <script src="https://iocast.github.io/jquery-3.3.1.min.js"></script>
  <script src="https://iocast.github.io/semantic/semantic.min.js"></script>
  <script src="https://iocast.github.io/masonry.pkgd.min.js"></script>


  <script>
    $(document)
      .ready(function () {
        
        $('.masthead')
          .visibility({
            once: false,
            onBottomPassed: function () {
              $('.fixed.menu').transition('fade in');
            },
            onBottomPassedReverse: function () {
              $('.fixed.menu').transition('fade out');
            }
          })
          ;
        
        $('.ui.sidebar')
          .sidebar('attach events', '.toc.item')
          ;
      });
  </script>


  <link rel="stylesheet" type="text/css" href="https://iocast.github.io/css/syntax.css">
  <link rel="stylesheet" type="text/css" href="https://iocast.github.io/css/main.css">

</head>
<body>

  
  <div class="ui large top fixed hidden menu">
    <div class="ui container">
      
      <a class=" item" href="https://iocast.github.io/">Home</a>
      
      <a class=" item" href="https://iocast.github.io/post/">Archives</a>
      
      <a class="active item" href="https://iocast.github.io/cheatsheet/">Cheatsheets</a>
      
      
    </div>
  </div>

  
  <div class="ui vertical inverted sidebar menu">
    
    <a class=" item" href="https://iocast.github.io/">Home</a>
    
    <a class=" item" href="https://iocast.github.io/post/">Archives</a>
    
    <a class="active item" href="https://iocast.github.io/cheatsheet/">Cheatsheets</a>
    
    
  </div>

  
  <div class="pusher">
    <div class="ui inverted vertical masthead center aligned segment">

      <div class="ui container">
        <div class="ui large secondary inverted pointing menu">
          <a class="toc item">
            <i class="sidebar icon"></i>
          </a>
          
          <a class=" item" href="https://iocast.github.io/">Home</a>
          
          <a class=" item" href="https://iocast.github.io/post/">Archives</a>
          
          <a class="active item" href="https://iocast.github.io/cheatsheet/">Cheatsheets</a>
          
          
        </div>
      </div>

      <div class="ui text container">
        <h1 class="ui inverted header">
          LINUX
        </h1>
        
      </div>

    </div>


    <div class="ui vertical stripe segment">
      <div class="ui middle aligned stackable grid container">
        <div class="row">
          <div class="sixteen  wide column">
            

<div class="main ui container sticky--container">

  <div class="ui dividing right rail">
    <div class="ui sticky">
      <h4 class="ui header">Linux</h4>
<nav id="TableOfContents">
<ul>
<li><a href="#user-group-management">User &amp; Group Management</a>
<ul>
<li><a href="#user-with-sudo-rights">User with <code>sudo</code> rights</a></li>
</ul></li>
<li><a href="#samba-management">Samba Management</a></li>
<li><a href="#file-and-directory-handling">File and Directory Handling</a>
<ul>
<li><a href="#find-remove">Find &amp; Remove</a></li>
<li><a href="#file-manipulation">File Manipulation</a>
<ul>
<li><a href="#r-command-not-found">&lsquo;\r&rsquo;: command not found</a></li>
</ul></li>
<li><a href="#folder-size">Folder size</a></li>
<li><a href="#compression">Compression</a></li>
<li><a href="#extraction">Extraction</a></li>
<li><a href="#errors">Errors</a></li>
<li><a href="#synchronization">Synchronization</a></li>
<li><a href="#cloning">Cloning</a></li>
</ul></li>
<li><a href="#job-programs">Job / Programs</a></li>
<li><a href="#system-information">System information</a></li>
<li><a href="#packages">Packages</a></li>
<li><a href="#network">Network</a>
<ul>
<li><a href="#wifi">WiFi</a></li>
</ul></li>
<li><a href="#todo">TODO</a></li>
</ul>
</nav>

    </div>
  </div>
  
  <div class="abstract">
    <p>
      <i>Linux general commands</i>
    </p>
  </div>

  <div>
    

<h1 class="ui header" id="user-group-management">User &amp; Group Management</h1>

</table><table class="ui celled table">
<thead>
<tr>
<th>Purpose</th>
<th>Command</th>
</tr>
</thead>

<tbody>
<tr>
<td>new group</td>
<td><code>groupadd sambashare</code></td>
</tr>

<tr>
<td>new user</td>
<td><code>useradd -m -g users -G sambashare -s /bin/bash unix_user</code></td>
</tr>

<tr>
<td>change password</td>
<td><code>passwd unix_user</code></td>
</tr>

<tr>
<td>rename user</td>
<td><code>usermod -l newUsername oldUsername</code> and change home folder <code>usermod -d /home/newHomeDir -m newUsername</code></td>
</tr>

<tr>
<td>change to root</td>
<td><code>sudo -i</code></td>
</tr>

<tr>
<td>remove user</td>
<td><code>deluser --remove-home username</code></td>
</tr>
</tbody>
</table>

<h2 class="ui header" id="user-with-sudo-rights">User with <code>sudo</code> rights</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">useradd --create-home --gid users --shell /bin/bash userName
passwd userName
visudo -f /etc/sudoers.d/sudoers

<span class="c1"># User privilege specification</span>
userName    <span class="nv">ALL</span><span class="o">=(</span>ALL:ALL<span class="o">)</span> ALL</code></pre></div>
<h1 class="ui header" id="samba-management">Samba Management</h1>

</table><table class="ui celled table">
<thead>
<tr>
<th>Purpose</th>
<th>Command</th>
</tr>
</thead>

<tbody>
<tr>
<td>new user</td>
<td><code>pdbedit -a -u samba_user</code></td>
</tr>

<tr>
<td>change password</td>
<td><code>smbpasswd samba_user</code></td>
</tr>

<tr>
<td>list users</td>
<td><code>pdbedit -w -L</code></td>
</tr>
</tbody>
</table>

<h1 class="ui header" id="file-and-directory-handling">File and Directory Handling</h1>

<h2 class="ui header" id="find-remove">Find &amp; Remove</h2>

<p>specific files</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">find &lt;path&gt; -name <span class="s1">&#39;&lt;file-name&gt;&#39;</span> -delete</code></pre></div>
<p>If something &ldquo;more portable&rdquo; needed then you&rsquo;re better off with</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">find &lt;directory name&gt; -name <span class="s1">&#39;*.pyc&#39;</span> -exec rm <span class="o">{}</span> <span class="se">\;</span></code></pre></div>
<h2 class="ui header" id="file-manipulation">File Manipulation</h2>

<p>search the line which begins with <code>var feature server</code> and replaces the whole line with <code>var featureserver = &quot;http://featureserver.org/fs&quot;</code></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sed -e <span class="s1">&#39;s%^var featureserver.*%var featureserver = &#34;http://featureserver.org/fs&#34;%g&#39;</span> featureserver.org/assets/js/map.js &gt; <span class="si">${</span><span class="nv">tmp</span><span class="si">}</span>/website/assets/js/map.js</code></pre></div>
<p>template command is as follow, where the first character after <code>s</code> is used as separator and afterwards it comes a regex. Use <code>-i</code> to do an &ldquo;in place&rdquo; replacement (no need for pipe)</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sed -ie <span class="s1">&#39;s/$search_for/$replace_with/g&#39;</span> <span class="nv">$file</span></code></pre></div>
<h3 class="ui header" id="r-command-not-found">&lsquo;\r&rsquo;: command not found</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># Error message</span>
-bash: <span class="s1">&#39;\r&#39;</span>: <span class="nb">command</span> not found</code></pre></div>
<p>Remove trailing <code>\r</code> character that causes this error:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sed -i <span class="s1">&#39;s/\r$//&#39;</span> filename</code></pre></div>
<p>Option <code>-i</code> is for in-place editing, we delete the trailing <code>\r</code> directly in the input file. Thus be careful to type the pattern correctly.</p>

<h2 class="ui header" id="folder-size">Folder size</h2>

<dl>
<dt><code>-h</code></dt>
<dd>human readable file size</dd>
<dt><code>-s</code></dt>
<dd>sum all subfolders</dd>
</dl>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">du &lt;directory&gt;</code></pre></div>
<h2 class="ui header" id="compression">Compression</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">tar -cvzf &lt;file.tar.bz2&gt; --exclude-vcs --exlude<span class="o">=</span><span class="s1">&#39;*.svn&#39;</span> folder/</code></pre></div>
<h2 class="ui header" id="extraction">Extraction</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">tar -zxvf &lt;file.tar.bz2&gt;</code></pre></div>
<h2 class="ui header" id="errors">Errors</h2>

<p>When you get a error that the command is not found (e.g. <code>-bash: $'\r': command not found</code>) and you are sure everything is correct, then it has something to do with the file format or the characters.</p>

<p><strong>Error:</strong> <code>-bash: $'\r': command not found</code></p>

<p>Remove trailing \r character that causes this error:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sed -i <span class="s1">&#39;s/\r$//&#39;</span> filename</code></pre></div>
<p>Option <code>-i</code> is for in-place editing, we delete the trailing <code>\r</code> directly in the input file. Thus be careful to type the pattern correctly.</p>

<h2 class="ui header" id="synchronization">Synchronization</h2>

<p>Synchronization</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#! /bin/bash
</span><span class="cp"></span>rsync -av --delete &lt;from&gt; &lt;to&gt; &gt; &lt;log&gt; <span class="p">&amp;</span></code></pre></div>
<h2 class="ui header" id="cloning">Cloning</h2>

<p>burning image to disk (also usb drives)</p>

<p>optional use <code>bs=8192</code></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">dd <span class="k">if</span><span class="o">=</span>&lt;path&gt;.iso <span class="nv">of</span><span class="o">=</span>&lt;disk&gt;</code></pre></div>
<h1 class="ui header" id="job-programs">Job / Programs</h1>

<p>Keep job running despite of a logout</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">nohup &lt;command&gt; <span class="p">&amp;</span></code></pre></div>
<h1 class="ui header" id="system-information">System information</h1>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">dmidecode -t <span class="o">[</span>bios, system, baseboard, chassis, processor, memory, cache, connector, slot<span class="o">]</span> <span class="p">|</span> more</code></pre></div>
<h1 class="ui header" id="packages">Packages</h1>

<p>getting installed packages including version number</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">time</span> dpkg -l <span class="p">|</span> perl -lane <span class="s1">&#39;print &#34;$F[1] : $F[2]&#34; if m/^ii/&#39;</span></code></pre></div>
<h1 class="ui header" id="network">Network</h1>

<h2 class="ui header" id="wifi">WiFi</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">wpa_passphrase &lt;ssid&gt;
<span class="c1"># reading passphrase from stdin</span> </code></pre></div>
<p>Enter your passphrase and confirm with enter. It will output the network configuration.</p>
<div class="highlight"><pre class="chroma"><code class="language-ini" data-lang="ini"><span class="na">network</span><span class="o">=</span><span class="s">{
</span><span class="s">        ssid=&#34;&lt;ssid&gt;&#34;
</span><span class="s">        #psk=&#34;&lt;passphrase&gt;&#34;
</span><span class="s">        psk=&#34;&lt;wpa-psk&gt;&#34;</span></code></pre></div>
<p>Open the file <code>/etc/network/interfaces</code></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">nano /etc/network/interfaces</code></pre></div>
<p>and change it as follow with the information provided by <code>wpa_passphrase</code>.</p>

<p>Check on wich interface your WiFi is connected.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ifconfig</code></pre></div>
<p>shows you alle interfaces.</p>
<div class="highlight"><pre class="chroma"><code class="language-ini" data-lang="ini"><span class="c1"># Primary Ethernet Set To DHCP</span>
<span class="na">auto eth0</span>
<span class="na">iface eth0 inet dhcp</span>

<span class="c1"># Wireless Interfaces wlan0 Set To DHCP using WPA2-PSK</span>
<span class="na">auto wlan0</span>
<span class="na">iface wlan0 inet dhcp</span>
        <span class="na">wpa-ssid &lt;ssid&gt;</span>
        <span class="na">wpa-psk &lt;wpa-psk&gt;</span></code></pre></div>
<p>Now you can start the WiFi</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ifup wlan0</code></pre></div>
<h1 class="ui header" id="todo">TODO</h1>

<p>current used image version
uname -r</p>

<p>list all unused images
sudo dpkg &ndash;list &lsquo;linux-image*&lsquo;|awk &lsquo;{ if ($1==&ldquo;ii&rdquo;) print $2}&rsquo;|grep -v <code>uname -r</code></p>

<p>sudo apt-get purge linux-image-4.4.0-108-generic</p>

<p>sudo apt-get autoremove</p>

<p>sudo update-grub</p>

<hr />

<p>Case II: Can&rsquo;t Use apt i.e. /boot is 100% full</p>

<p>sudo dpkg &ndash;list &lsquo;linux-image*&lsquo;|awk &lsquo;{ if ($1==&ldquo;ii&rdquo;) print $2}&rsquo;|grep -v <code>uname -r</code></p>

<p>sudo rm -rf /boot/<em>-4.4.0-{108,109,112,116,119,121,124}-</em></p>

<p>sudo apt-get -f install</p>

<p>sudo apt-get autoremove</p>

<p>sudo update-grub</p>

<p>sudo apt-get update</p>

  </div>

</div>

<script>
  $('.ui.sticky').sticky({
    context: '.sticky--container',
    offset: 56
  });
</script>


          </div>
        </div>
      </div>
    </div>

  </div>

  </body>

</html>
